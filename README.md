# SAF-GMP

Codes for "SAF-GMP: Structure and Feature Enhanced Global Message Passing for Heterophilic Graphs"

## Statistics of the Node Classification Datasets

|                 | **Actor** | **Roman** | **Amazon** | **Minesweeper** | **Tolokers** | **Cora** | **Pubmed** |
|-----------------|-----------|-----------|------------|-----------------|--------------|----------|------------|
| **#Nodes**      | 7,600     | 22,662    | 24,492     | 10,000          | 11,758       | 2,708    | 19,717     |
| **#Edges**      | 26,659    | 32,927    | 93,050     | 39,402          | 519,000      | 5,278    | 44,324     |
| **#Features**   | 931       | 300       | 300        | 7               | 10           | 1,433    |  500       |
| **#Classes**    | 5         | 18        | 5          | 2               | 2            | 7        | 3          |
| **h_edge**| 0.22      | 0.05      | 0.38       | 0.68            | 0.59         | 0.81     | 0.80       |
| **LI**          | 0.00      | 0.11      | 0.04       | 0.00            | 0.01         | 0.59     | 0.41       |



## Performance of GMP-GNN and Other Popular GNN Models on Both Heterophily and Homophily Graph Datasets

| **Model**      | **Actor**                   | **Roman**             | **Amazon**            | **Minesweeper**        | **Tolokers**          | **Cora**             | **Pubmed**            |
|-----------------|----------------------------|-----------------------|-----------------------|------------------------|-----------------------|-----------------------|-----------------------|
| ResNet         | 33.47±0.75                 | 65.88±0.38           | 45.90±0.52           | 50.89±1.39            | 72.95±1.06           | 74.95±2.09           | 86.78±0.38           |
| GCN            | 34.96±1.10                 | 73.69±0.74           | 48.70±0.63           | 89.75±0.52            | 83.64±0.67           | 86.60±0.95           | 88.18±0.50           |
| GraphSage      | 35.68±0.72                 | 85.74±0.67           | 53.63±0.39           | 93.51±0.57            | 82.43±0.44           | 86.66±1.42           | 88.83±0.50           |
| GAT            | 34.82±1.17                 | 80.87±0.30           | 49.09±0.63           | 92.01±0.68            | 83.70±0.47           | 86.80±1.02           | 87.82±0.43           |
| GATv2          | 35.66±0.70                 | 85.69±0.57           | 49.71±0.68           | 91.53±0.66            | 82.93±0.62           | 86.73±1.15           | 87.81±0.52           |
| H2GCN          | 35.09±1.00                 | 60.11±0.52           | 36.47±0.23           | 89.71±0.31            | 73.35±0.01           | 87.12±0.81           | 88.53±0.42           |
| GBK-GNN        | 34.38±0.67                 | 74.57±0.47           | 45.98±0.71           | 90.85±0.58            | 81.01±0.67           | 86.74±0.74           | 88.79±0.53           |
| GCNII          | 34.88±0.85                 | 79.33±0.56           | 49.70±0.68           | 89.64±1.18            | 84.89±0.54           | 86.12±0.88           | 88.80±0.43           |
| FSGNN          | 35.21±0.66                 | 79.92±0.56           | 52.74±0.83           | 90.08±0.70            | 82.76±0.61           | 85.49±1.15           | 89.31±0.37           |
| OrderedGNN     | 36.01±1.13                 | 81.92±0.79           | 52.35±0.55           | 90.13±1.77            | 81.85±0.87           | 86.96±1.44           | 89.07±0.52           |
| GPR-GNN        | 34.70±0.86                 | 64.85±0.27           | 44.88±0.34           | 86.24±0.61            | 72.94±0.97           | 87.63±1.59           | 88.58±0.48           |
| FAGCN          | 34.95±1.36                 | 65.22±0.56           | 44.12±0.30           | 88.17±0.73            | 77.75±1.05           | 87.89±0.85           | 89.32±0.28           |
| JacobiConv     | 35.54±0.85                 | 71.14±0.42           | 43.55±0.48           | 89.66±0.40            | 68.66±0.65           | 86.76±0.98           | 89.02±0.39           |
| ALT-APPNP      | 32.41±1.27                 | 69.13±0.43           | 43.81±0.37           | 80.19±0.26            | 78.60±0.62           | 85.01±0.86           | 89.06±0.48           |
| GT             | 33.86±1.04                 | 86.51±0.73           | 51.17±0.66           | 91.85±0.76            | 83.23±0.64           | 86.76±1.30           | 87.17±0.58           |
| GraphGPS       | 36.53±0.68                 | 87.04±0.58           | 51.03±0.60           | 93.85±0.41            | 84.81±0.86           | 86.56±1.01           | 88.94±0.57           |
| GloGNN++       | 35.42±0.76                 | 59.63±0.69           | 36.89±0.14           | 51.08±1.23            | 73.39±1.17           | **88.33±1.09**       | 89.24±0.39           |
| LRGNN          | 36.86±0.86                 | 62.29±1.33           | 36.79±0.49           | 80.00±0.00            | 78.51±0.38           | 88.26±1.02           | 89.26±0.62           |
| **GMP-GNN**    | **37.04±0.80**             | **90.21±0.62**       | **53.72±0.41**       | **96.32±0.42**        | **85.11±0.64**       | 87.53±1.32           | **89.72±0.37**       |


## Ablation Performance (%) of GMP-GNN on Different Datasets

| **Model**         | **Actor**    | **Roman**    | **Amazon**   | **Minesweeper** | **Tolokers**  | **Cora**     | **Pubmed**   |
|--------------------|--------------|--------------|--------------|-----------------|---------------|--------------|--------------|
| (1) w/o GVN       | 36.12        | 89.51        | 52.71        | 95.05           | 84.51         | 86.57        | 88.80        |
| (2) w/o GEA       | 36.80        | 89.47        | 52.82        | 95.11           | 84.14         | 86.46        | 89.12        |
| (3) w/o m'  | 36.87        | 86.82        | 52.72        | 94.62           | 84.06         | 86.31        | 89.48        |
| (4) w/o m'' | 36.64        | 88.53        | 53.03        | 95.40           | 83.74         | 85.71        | 88.95        |
| (5) w/o m''' | 36.43        | 88.33        | 52.12        | 95.67           | 83.60         | 86.92        | 88.84        |
| (6) GMP-GNN        | **37.04**   | **90.21**    | **53.72**    | **96.32**       | **85.11**     | **87.53**    | **89.72**    |


## Node classification performances for over-smoothing problems with various depths
<img width="847" alt="截屏2025-01-28 09 58 45" src="https://github.com/user-attachments/assets/7dedeae6-6718-40e7-a50d-872781aa04bb" />

## Dirichlet Energy of 64 Layers for GloMP-GNN After Training

The higher energy indicates that it is less prone to over-smoothing.

| **Model**       | **Actor**   | **Minesweeper** | **Cora**    |
|------------------|-------------|-----------------|-------------|
| **GCN**         | 0.1633      | 0.0007          | 0.0791      |
| **GCNII**       | 0.3155      | 0.4312          | 0.1562      |
| **GMP-GNN**   | 0.7176      | 0.5936          | 0.2782      |


## Comparison of GCN and GMP-GNN visualizations obtained from 64 layers of feature representations in two-dimensional space on Roman-empire dataset.
<img width="401" alt="截屏2025-01-28 10 01 29" src="https://github.com/user-attachments/assets/8935ac75-9e27-47eb-8d8f-89b1587b823b" />

